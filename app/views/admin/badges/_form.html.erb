<div class='col-6'>
  <%= form_with model: [:admin, @badge], data: { turbo: false } do |form| %>
    <%= render 'errors', resource: @badge %>
    <div class="mb-3">
      <%= form.label :title %>
      <%= form.text_field :title, class: 'form-control' %>
    </div>
    <div class="mb-3">
      <%= form.label :url %>
      <%= form.text_area :url, class: 'form-control' %>
    </div>
    <div class="mb-3" data-controller='rule' 
      data-rule-select-value='<%= @badge.rule %>'
      data-rule-index-value='<%= get_index(@badge.rule, @badge.parameter) %>' 
      
     >
      <%= form.label :rule %>
      <p>
        <%= form.select :rule, options_for_select(Badge.rules.map { |k, _v| [k.capitalize, k] }, @badge.rule), {}, class: 'form-select',
        data: { action: 'change->rule#change_rule' }
      %>
      </p>
      <div class="mb-3">
        <%= form.collection_select random_id, 
          Category.unscoped.all, :id, :title, {}, 
          { class: 'form-select hide',
           'data-rule-target': 'category',
           'data-action': 'change->rule#change_foo' } %>
        <%= form.collection_select random_id, Test.order(:id), :id, :title, {}, 
          { class: 'form-select hide', 
          'data-rule-target': 'test',
          'data-action': 'change->rule#change_foo' } %>
        <%= form.collection_select random_id, Test.order(:level).select(:level).distinct, :level, :level, {}, 
          { class: 'form-select hide',
           'data-rule-target': 'level',
           'data-action': 'change->rule#change_foo' } %>
      </div>
      <%= form.number_field :parameter, class: 'form-control hide',
      'data-rule-target': 'parameter' %>
    </div>
    <%= form.submit class: 'mt-3 btn btn-primary' %>
  <% end %>
</div>
